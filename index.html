<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Music Full</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Montserrat:wght@400;700&display=swap');
        :root { --bg: #050505; --cyan: #00f2ff; --card: #111; }
        body { margin: 0; background: var(--bg); color: white; font-family: 'Montserrat', sans-serif; overflow-x: hidden; }
        
        .header { padding: 20px; text-align: center; border-bottom: 1px solid rgba(0,242,255,0.3); }
        .header h1 { font-family: 'Orbitron', sans-serif; font-size: 18px; color: var(--cyan); margin: 0; text-shadow: 0 0 10px var(--cyan); }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –ø–ª–µ–µ—Ä–∞ YouTube */
        #video-container { width: 100%; height: 200px; background: #000; display: none; margin-bottom: 10px; border-bottom: 2px solid var(--cyan); }

        .search-section { padding: 15px; }
        .search-bar { width: 100%; padding: 15px; border-radius: 12px; border: 1px solid #333; background: #111; color: white; outline: none; box-sizing: border-box; }

        .playlist { padding: 0 15px 100px; }
        .track-card { background: var(--card); border-radius: 15px; padding: 15px; display: flex; align-items: center; margin-bottom: 10px; border: 1px solid rgba(255,255,255,0.05); }
        .track-info { flex-grow: 1; }
        .t-title { font-weight: 700; font-size: 15px; display: block; color: var(--cyan); }
        .t-artist { font-size: 12px; color: #888; }
        
        .play-btn { background: var(--cyan); color: black; border: none; padding: 8px 15px; border-radius: 8px; font-weight: bold; cursor: pointer; }

        .results { position: absolute; top: 130px; left: 15px; right: 15px; background: #1a1a1a; border-radius: 10px; z-index: 100; display: none; border: 1px solid #444; max-height: 250px; overflow-y: auto; }
        .res-item { padding: 12px; border-bottom: 1px solid #222; display: flex; justify-content: space-between; align-items: center; }
    </style>
</head>
<body>

    <div class="header"><h1>NEON PLAYER FULL</h1></div>

    <div id="video-container"></div>

    <div class="search-section">
        <input type="text" class="search-bar" id="search-input" placeholder="üîç –í–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏..." oninput="searchMusic()">
    </div>

    <div class="results" id="results"></div>
    <div class="playlist" id="playlist"></div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        let tracks = [];

        async function searchMusic() {
            const query = document.getElementById('search-input').value;
            const resDiv = document.getElementById('results');
            if (query.length < 3) { resDiv.style.display = 'none'; return; }

            const response = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(query)}&entity=song&limit=5`);
            const data = await response.json();

            resDiv.innerHTML = '';
            data.results.forEach(song => {
                const item = document.createElement('div');
                item.className = 'res-item';
                item.innerHTML = `
                    <div><b>${song.trackName}</b><br><small>${song.artistName}</small></div>
                    <button class="play-btn" onclick="addTrack('${song.trackName.replace(/'/g,"")}', '${song.artistName.replace(/'/g,"")}')">+</button>
                `;
                resDiv.appendChild(item);
            });
            resDiv.style.display = 'block';
        }

        function addTrack(title, artist) {
            const id = Date.now();
            tracks.push({ id, title, artist });
            document.getElementById('results').style.display = 'none';
            document.getElementById('search-input').value = '';
            render();
            tg.HapticFeedback.notificationOccurred('success');
        }

        function playFull(title, artist) {
            const container = document.getElementById('video-container');
            const query = encodeURIComponent(`${artist} ${title} official audio`);
            
            // –í—Å—Ç–∞–≤–ª—è–µ–º YouTube –ø–ª–µ–µ—Ä —á–µ—Ä–µ–∑ DuckDuckGo –ø—Ä–æ–∫—Å–∏ (—Å–∞–º—ã–π —Å—Ç–∞–±–∏–ª—å–Ω—ã–π –º–µ—Ç–æ–¥)
            container.innerHTML = `<iframe width="100%" height="100%" src="https://www.youtube.com/embed?listType=search&list=${query}" frameborder="0" allow="autoplay; encrypted-media" allowfullscreen></iframe>`;
            container.style.display = 'block';
            
            tg.HapticFeedback.impactOccurred('medium');
            window.scrollTo(0, 0); // –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–≤–µ—Ä—Ö –∫ –ø–ª–µ–µ—Ä—É
        }

        function render() {
            const container = document.getElementById('playlist');
            container.innerHTML = '';
            tracks.reverse().forEach(t => {
                const card = document.createElement('div');
                card.className = 'track-card';
                card.innerHTML = `
                    <div class="track-info">
                        <span class="t-title">${t.title}</span>
                        <span class="t-artist">${t.artist}</span>
                    </div>
                    <button class="play-btn" onclick="playFull('${t.title}', '${t.artist}')">PLAY</button>
                `;
                container.appendChild(card);
            });
        }
    </script>
</body>
</html>
