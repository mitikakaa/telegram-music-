<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Music RU</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { 
            background: #050505; color: white; 
            font-family: sans-serif; margin: 0; padding: 0; 
        }
        .header { 
            padding: 20px; text-align: center; 
            border-bottom: 2px solid #00f2ff; color: #00f2ff;
            text-shadow: 0 0 10px #00f2ff;
        }
        .search-box { padding: 15px; }
        input { 
            width: 100%; padding: 15px; border-radius: 10px; 
            border: 1px solid #333; background: #111; color: white;
            box-sizing: border-box;
        }
        .track-list { padding: 15px; }
        .track-card { 
            background: #111; border: 1px solid #222; 
            padding: 15px; border-radius: 12px; margin-bottom: 10px;
            display: flex; justify-content: space-between; align-items: center;
        }
        .play-btn { 
            background: #00f2ff; color: black; border: none; 
            padding: 10px 20px; border-radius: 8px; font-weight: bold;
        }
        #player-ui {
            position: fixed; bottom: 0; width: 100%;
            background: #111; border-top: 2px solid #00f2ff;
            padding: 20px; display: none; box-sizing: border-box;
        }
        audio { width: 100%; margin-top: 10px; }
        .results { 
            background: #1a1a1a; border: 1px solid #444; 
            border-radius: 10px; margin-top: 5px; display: none;
        }
        .res-item { padding: 10px; border-bottom: 1px solid #333; display: flex; justify-content: space-between; }
    </style>
</head>
<body>

<div class="header"><h1>NEON MUSIC</h1></div>

<div class="search-box">
    <input type="text" id="search" placeholder="üîç –í–≤–µ–¥–∏ –Ω–∞–∑–≤–∞–Ω–∏–µ –ø–µ—Å–Ω–∏..." oninput="doSearch()">
    <div id="results" class="results"></div>
</div>

<div id="list" class="track-list"></div>

<div id="player-ui">
    <div id="track-name" style="color:#00f2ff; font-weight:bold; margin-bottom:5px;"></div>
    <audio id="audio" controls autoplay></audio>
</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.expand();

    async function doSearch() {
        const q = document.getElementById('search').value;
        const resDiv = document.getElementById('results');
        if (q.length < 3) { resDiv.style.display = 'none'; return; }

        const r = await fetch(`https://itunes.apple.com/search?term=${encodeURIComponent(q)}&entity=song&limit=5`);
        const d = await r.json();

        resDiv.innerHTML = '';
        d.results.forEach(s => {
            const div = document.createElement('div');
            div.className = 'res-item';
            div.innerHTML = `
                <span>${s.trackName}</span>
                <button onclick="add('${s.trackName.replace(/'/g,"")}','${s.artistName.replace(/'/g,"")}','${s.previewUrl}')" style="background:#00f2ff;border:none;border-radius:5px;padding:5px;">ADD</button>
            `;
            resDiv.appendChild(div);
        });
        resDiv.style.display = 'block';
    }

    function add(t, a, url) {
        const container = document.getElementById('list');
        const card = document.createElement('div');
        card.className = 'track-card';
        card.innerHTML = `
            <div><b>${t}</b><br><small>${a}</small></div>
            <button class="play-btn" onclick="play('${url}','${t}')">PLAY</button>
        `;
        container.prepend(card);
        document.getElementById('results').style.display = 'none';
        document.getElementById('search').value = '';
    }

    function play(url, name) {
        document.getElementById('player-ui').style.display = 'block';
        document.getElementById('track-name').innerText = "–°–µ–π—á–∞—Å –∏–≥—Ä–∞–µ—Ç: " + name;
        const a = document.getElementById('audio');
        a.src = url;
        a.play();
        tg.HapticFeedback.impactOccurred('medium');
    }
</script>

</body>
</html>
